## < 자바의 메모리 구조 - 스택/힙/메서드 >
![](https://velog.velcdn.com/images/austinan/post/b23e81f4-fd58-469c-8d92-c6826d9b74e4/image.png)

- **메서드 영역** : 클래스 정보를 보관한다. 이 클래스 정보가 붕어빵 틀이다.
- **스택 영역** : 실제 프로그램이 실행되는 영역이다. 메서드를 실행할 때 마다 하나씩 쌓인다.
- **힙 영역** : 객체(인스턴스)가 생성되는 영역이다. new 명령어를 사용하면 이 영역을 사용한다. 쉽게 이야기해서 붕어빵 틀로부터 생성된 붕어빵이 존재하는 공간이다. 참고로 배열도 이 영역에 생성된다.

### 각 영역 설명

![](https://velog.velcdn.com/images/austinan/post/44a0cfe9-7efa-4c2b-ae2a-618e6a66f001/image.png)

- 메서드 영역(Method Area): 메서드 영역은 프로그램을 실행하는데 필요한 “공통 데이터”를 관리한다. 이 영역은 프로그램의 모든 영역에서 공유한다.
    - 클래스 정보: 클래스의 실행 코드(바이트 코드), 필드, 메서드와 생성자 코드등 “모든 실행 코드”가 존재한다.
    - static 영역: “static 변수”들을 보관한다. (⇒뒤에서 자세히 설명한다.)
    - 런타임 상수 풀: 프로그램을 실행하는데 필요한 “공통 리터럴 상수”를 보관한다. 예를 들어서 프로그램에 "hello" 라는 리터럴 문자가 있으면 이런 문자를 공통으로 묶어서 관리한다. 이 외에도 프로그램을 효율적으로 관리하기 위한 상수들을 관리한다. (⇒자바가 최적화하는 것이기 때문에 우리가 크게 신경쓸 필요는 없다.)

- 스택 영역(Stack Area): 자바 실행 시, 하나의 실행 스택이 생성된다. 각 스택 프레임은 지역 변수, 중간 연산 결과, 메서드 호출 정보 등을 포함한다.
    - 스택 프레임: 스택 영역에 쌓이는 네모 박스가 하나의 스택 프레임이다. 메서드를 호출할 때 마다 하나의 스택 프레임이 쌓이고, 메서드가 종료되면 해당 스택 프레임이 제거된다.

  +) 스택 영역은 더 정확히는 각 쓰레드별로 하나의 실행 스택이 생성된다. 따라서 쓰레드 수 만큼 스택 영역이 생성된다.

- 힙 영역(Heap Area): 객체(인스턴스)와 배열이 생성되는 영역이다. 가비지 컬렉션(GC)이 이루어지는 주요 영역이며, 더 이상 참조되지 않는 객체는 GC에 의해 제거된다.

+) PC Register : Thread가 생성될 때 마다 생기는 공간으로 Thread가 어떠한 명령을 실행하게 될지에 대한 부분을 기록하는 공간.

+) Native Method Stack : Native Method 즉, 자바 프로그래밍 언어 이외의 언어로 작성된 메서드를 지원하기 위한 스택.

## < 스택, 큐 자료구조 >

### 정리

- 자바는 스택 영역을 사용해서 메서드 호출과 지역 변수(매개변수 포함)를 관리한다.
- 메서드를 계속 호출하면 스택 프레임이 계속 쌓인다.
- 스택 프레임이 종료되면 지역 변수도 함께 제거된다.
- 스택 프레임이 모두 제거되면 프로그램도 종료된다.

![](https://velog.velcdn.com/images/austinan/post/255fb91d-7d5d-4f53-b0b3-fb9b93c1fe4b/image.png)

-> 메서드 종료 직후에 GC(가비지 컬렉션) 은 이렇게 참조가 모두 사라진 인스턴스를 찾아서 메모리에서 제거한다.
-> 힙 영역 외부가 아닌, 힙 영역 안에서만 인스턴스끼리 서로 참조하는 경우에도 GC 의 대상이 된다.